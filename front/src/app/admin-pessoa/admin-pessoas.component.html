<div class="container">
    <div class="topbar">
        <h2>Pessoas cadastradas</h2>
        <div class="actions">
        <span class="filter">
          <input pInputText type="text" placeholder="Filtrar por nome" (input)="dt.filterGlobal($any($event.target).value, 'contains')" />
        </span>
            <input type="file" (change)="onFile($event)" accept=".csv" />
            <button pButton label="Importar CSV" (click)="upload()" [disabled]="!file || uploading"></button>
            <button pButton label="Download Links" class="p-button-success" (click)="exportLinks()"></button>
            <button pButton label="Sair" class="p-button-secondary" (click)="logout()"></button>
        </div>
    </div>

    <p-table #dt [value]="pessoas" [tableStyle]="{ 'min-width': '50rem' }" [paginator]="true" [rows]="10" [globalFilterFields]="['contato','primeiroNome']">
        <ng-template pTemplate="header">
            <tr>
                <th>Contato</th>
                <th>Primeiro Nome</th>
                <th>Magic</th>
                <th>Slug</th>
                <th style="width:140px">Ações</th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-p>
            <tr>
                <td>{{ p.contato }}</td>
                <td>{{ p.primeiroNome }}</td>
                <td>{{ p.numeroMagico }}</td>
                <td>{{ p.slug }}</td>
                <td class="acoes">
                    <button pButton size="small" label="Abrir link" (click)="openLink(p)"></button>
                    <button pButton size="small" label="Copiar link" class="p-button-secondary" (click)="copyLink(p)"></button>
                </td>
            </tr>
        </ng-template>
    </p-table>

    <p *ngIf="loading" class="hint">Carregando...</p>
</div>

<p-toast></p-toast>
